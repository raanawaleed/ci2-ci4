/**
 * This file is part of Your Calendar app. It requires license to use.
 * Copyright (c) 2020 flexphperia.net All rights reserved.
 * 
 * @preserve
 */
 +function(e){"use strict";var t=function(e,t){this.$element=null,this.$iconList=null,this.$selectedList=null,this.$input=null,this.options=null,this.selectedItemTemplate='<a href="" ><span class="text-body" >&times;</span></a>',this.init(e,t)};t.prototype.init=function(t,i){this.$element=e(t),this.$iconList=this.$element.find(".icon-list"),this.$selectedList=this.$element.find(".selected-list"),this.$input=this.$element.find('input[type="hidden"]'),this.$element.is(".icon-selector")||alert("Wrong element"),this.options=this.getOptions(i);var n=this;this.$element.toggleClass("show-headers",this.options.showSectionHeaders),this.$element.toggleClass("multi",this.options.multi),this.$element.on("click.IconSelector",".icon-list a",function(e,t){e.preventDefault(),n.listClickHandler(this,t)}),this.options.multi&&this.$element.on("click.IconSelector",".selected-list a",function(e){e.preventDefault(),n.selectedListClickHandler(this)}),this.update()},t.prototype.getOptions=function(e){var t={multi:!1,showSectionHeaders:!0};for(var i in e)t[i]=e[i];return t},t.prototype.listClickHandler=function(t,i){var n=e(t);if(this.options.multi){if(n.hasClass("selected"))return;n.addClass("selected");var a=e(this.selectedItemTemplate),s=n.find(".icon").clone();a.prepend(s),a.attr("href",n.attr("href")),this.$selectedList.append(a)}else this.$iconList.find(".selected").removeClass("selected"),n.addClass("selected");i||(this._toInput(),this._updateEmptyLabel())},t.prototype.selectedListClickHandler=function(t){var i=e(t),n=i.attr("href");i.remove(),this.$iconList.find('a[href="'+n+'"]').removeClass("selected"),this._toInput(),this._updateEmptyLabel()},t.prototype._toInput=function(){var t=[];this.$iconList.find("a.selected").each(function(){t.push(e(this).attr("href"))}),this.$input.val(t.join(","))},t.prototype._fromInput=function(){var e=this.getValue(),t=this;if(e){var i=e.split(",");i.forEach(function(e){t.$iconList.find('a[href="'+e+'"]').trigger("click",[!0])})}},t.prototype._scrollToSelected=function(){var e=this.$iconList.find(".selected").eq(0);if(e.length){var t=e.position().top+this.$iconList.scrollTop();this.$iconList.scrollTop(t-e.outerHeight())}},t.prototype._updateEmptyLabel=function(){this.options.multi&&this.$selectedList.find(".empty").toggleClass("d-none",this.getValue().length?!0:!1)},t.prototype.getValue=function(){return this.$input.val()},t.prototype.setValue=function(e){this.$input.val(e),this._fromInput(),this._scrollToSelected()},t.prototype.update=function(){this._fromInput(),this._updateEmptyLabel(),this._scrollToSelected()},t.prototype.destroy=function(){},e.fn.iconSelector=function(i,n){var a=e(this).first(),s=a.data("flexphperia.IconSelector"),o="object"==typeof i&&i;return s||!/destroy/.test(i)?(s||a.data("flexphperia.IconSelector",s=new t(this,o)),"string"==typeof i?s[i](n):this):void 0},e.fn.iconSelector.Constructor=t}(jQuery),+function(e){"use strict";var t=function(e,t){this.$element=null,this.options=null,this.init(e,t)};t.prototype.init=function(t,i){this.$element=e(t),this.options=this.getOptions(i);var n=this;this.$element.popover({trigger:"click",html:!0,sanitize:!1,content:function(t){return e("#monthSelector").get(0).outerHTML},placement:"bottom",template:'<div class="popover months-popover" role="tooltip"><div class="arrow"></div><div class="popover-body"></div></div>'}).on("shown.bs.popover",function(t){var i=e(t.target),a=i.data()["bs.popover"],s=e(a.tip);s.on("click","button",function(){var t=e(this),i=t.siblings(".year"),n=t.is("[data-next]")?1:-1;t.siblings(".year").text(parseInt(i.text())+n)}),s.on("click","a.dropdown-item",function(t){t.preventDefault(),i.popover("hide");var a=parseInt(s.find(".year").text()),o=parseInt(e(this).data("num"));e("#monthSelector").data("month",o),n._updateSelection(),n.$element.triggerHandler("change",{year:a,month:o})}),mainCtrl.$body.on("click.monthPopover",function(t){var i=e(t.target);if(!i.closest(".months-popover").length&&!i.is(".months-popover")){var n=e(e(".months-popover").data("bs.popover").element);n.popover("hide")}})}).on("hidden.bs.popover",function(t){var i=e(t.target),n=i.data()["bs.popover"],a=e(n.tip);a.off("click"),mainCtrl.$body.off("click.monthPopover")}),this._updateSelection()},t.prototype.getOptions=function(e){var t={};for(var i in e)t[i]=e[i];return t},t.prototype._updateSelection=function(){e("#monthSelector").find(".dropdown-item").removeClass("active").eq(parseInt(e("#monthSelector").data("month"))-1).addClass("active")},t.prototype.destroy=function(){mainCtrl.$body.off(".monthPopover")},e.fn.monthSelector=function(i,n){var a=e(this).first(),s=a.data("flexphperia.MonthSelector"),o="object"==typeof i&&i;return s||!/destroy/.test(i)?(s||a.data("flexphperia.MonthSelector",s=new t(this,o)),"string"==typeof i?s[i](n):this):void 0},e.fn.monthSelector.Constructor=t}(jQuery),+function(e){"use strict";var t=function(e,t){this.$element=null,this.$button=null,this.$wrongExt=null,this.$error=null,this.$progress=null,this.$preview=null,this.$inputValue=null,this.$inputPreview=null,this.uploader=null,this.options=null,this.init(e,t)};t.prototype.init=function(t,i){this.$element=e(t),this.options=this.getOptions(i);var n=this;this.$button=this.$element.find("button[data-upload]"),this.$clear=this.$element.find("button[data-clear]"),this.$wrongExt=this.$element.find("[data-wrong-ext]"),this.$error=this.$element.find("[data-error]"),this.$progress=this.$element.find(".progress"),this.$preview=this.$element.find(".preview"),this.$previewImg=this.$element.find(".preview img"),this.$inputValue=this.$element.find('input[type="hidden"]'),this.uploader=new ss.SimpleUpload({button:this.$button,url:this.options.url,name:"file",responseType:"json",allowedExtensions:this.options.allowedExtensions,accept:this.options.accept,hoverClass:"hover",onChange:function(e,t,i,a,s){n.$progress.find(".progress-bar").width("0%").text("0%"),n.$wrongExt.add(n.$error).add(n.$progress).addClass("d-none"),n.$inputValue.val(""),n.updatePreview()},onExtError:function(e,t){n.$wrongExt.removeClass("d-none").find("[data-ext]").text(t)},onError:function(e,t,i,a,s,o,r){n.$progress.addClass("d-none"),n.$error.removeClass("d-none").find("[data-status]").text(t+", "+a)},onProgress:function(e){n.$progress.find(".progress-bar").width(e+"%").text(e+"%")},onSubmit:function(e,t){n.$progress.removeClass("d-none")},onComplete:function(e,t){n.$progress.addClass("d-none"),n.$inputValue.val(t.data),n.updatePreview("temp")}}),this.$clear.click(function(){n.$inputValue.val(""),n.updatePreview()}),this.updatePreview()},t.prototype.getOptions=function(e){var t={action:"",allowedExtensions:["jpg","png"],accept:".jpg,.png",previewWidth:100};for(var i in e)t[i]=e[i];return t.url=YourCalendar.siteUrl+"upload/"+t.action,t},t.prototype.updatePreview=function(e){e=e?e:"uploads";var t=this.$inputValue.val();this.$previewImg.toggleClass("d-none",t?!1:!0),t&&this.$previewImg.attr("src",YourCalendar.imgGeneratorUrl+"?dir="+e+"&width="+this.options.previewWidth+"&filename="+t),this.$preview.find(".no-image").toggleClass("d-none",t?!0:!1)},t.prototype.destroy=function(){this.uploader.destroy()},e.fn.uploader=function(i,n){var a=e(this).first(),s=a.data("flexphperia.Uploader"),o="object"==typeof i&&i;return s||!/destroy/.test(i)?(s||a.data("flexphperia.Uploader",s=new t(this,o)),"string"==typeof i?s[i](n):this):void 0},e.fn.uploader.Constructor=t}(jQuery),/* 
 Copyright (C) 2020 Michał Gańko <flexphperia(at)gmail.com>
 @license: This file can not be copied, modified and/or distributed without the express permission of author.
 */
+function(e){"use strict";window.emiterBase={_callbacks:null,on:function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},once:function(e,t){function i(){this.off(e,i),t.apply(this,arguments)}return i.fn=t,this.on(e,i),this},off:function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i="",n=e.indexOf(":");i=0==n?e+"$":-1==n?"^\\$"+e:"^\\$"+e+"$";for(var a in this._callbacks)if(new RegExp(i).test(a))if(t)for(var s=this._callbacks[a].length-1;s>=0;s--){var o=this._callbacks[a][s];if(o===t){this._callbacks[a].splice(s,1);break}}else delete this._callbacks[a];return this},emit:function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),i=[];for(var n in this._callbacks){var a=n.split(":")[0];a=="$"+e&&(i=i.concat(this._callbacks[n]))}var s=!1;if(i){i=i.slice(0);for(var o=0,r=i.length;r>o;++o)s=i[o].apply(this,t)===!1||s}return!s},listeners:function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]}}}($);

